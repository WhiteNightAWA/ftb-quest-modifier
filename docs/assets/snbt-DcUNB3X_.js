const b=Object.prototype.toString;function y(r){return(r/1).toString().includes(".")?r/1:(r/1).toFixed(1)}function g(r,e){if(e=="key")return`<span style="color:aqua">${r}</span>`;if(e=="str")return`<span style="color:rgb(84,351,84)">${r}</span>`;if(e=="num")return`<span style="color:orange">${r}</span>`;if(e=="bool")return`<span style="color:yellow">${r}</span>`;if(e=="unit")return`<span style="color:red">${r}</span>`}class x{constructor(e){if(this.childs={},this.addChild=function(t,i){this.childs[t]=i},this.isempty=function(){return Object.keys(this.childs).length==0},this.get=function(){var t=Array.prototype.slice.call(arguments);return b.call(t[0])=="[object Array]"&&(t=t[0]),t.length==1&&(t=E(t[0])),t.length==1?this.childs[t[0]]:t.length>1?this.childs[t[0]].get(t.slice(1)):this},this.set=function(t,i){["[object String]","[object Number]"].includes(b.call(t))?this.childs[t]=i:b.call(t)=="[object Array]"&&(t.length==1?this.childs[t[0]]=i:t.length>1&&this.get(t.slice(0,-1)).set(t.slice(-1),i))},this.text=function(t){var i=[];for(var l in this.childs)i.push(`${t?g(l,"key"):l}: ${this.childs[l].text(t)}`);return`{${i.join(", ")}}`},e)for(var n in e)this.addChild(n,e[n])}}class I{constructor(e){if(this.childs=[],this.addChild=function(t){this.childs.push(t)},this.isempty=function(){return this.childs.length==0},this.get=function(){var t=Array.prototype.slice.call(arguments);return b.call(t[0])=="[object Array]"&&(t=t[0]),t.length==1&&(t=E(t[0])),t.length==1?this.childs[t[0]]:t.length>1?this.childs[t[0]].get(t.slice(1)):this},this.set=function(t,i){["[object String]","[object Number]"].includes(b.call(t))?this.childs[t]=i:b.call(t)=="[object Array]"&&(t.length==1?this.childs[t[0]]=i:t.length>1&&this.get(t.slice(0,-1)).set(t.slice(-1),i))},this.text=function(t){for(var i=[],l=0;l<this.childs.length;l++)i.push(this.childs[l].text(t));return`[${i.join(", ")}]`},e)for(var n=0;n<e.length;n++)this.addChild(e[n])}}class N{constructor(e){if(this.childs=[],this.addChild=function(t){if(t instanceof m&&t.unit=="")this.childs.push(t);else throw new Error("NbtIntArray only accept NbtNumber without unit")},this.isempty=function(){return this.childs.length==0},this.get=function(){var t=Array.prototype.slice.call(arguments);if(b.call(t[0])=="[object Array]"&&(t=t[0]),t.length==1&&(t=E(t[0])),t.length==1)return this.childs[t[0]];if(t.length>1)throw new Error("NbtIntArray only accept one index");return this},this.set=function(t,i){if(t.length==1)if(i instanceof m&&i.unit=="")this.childs[t[0]]=i;else throw new Error("NbtIntArray only accept NbtNumber without unit");else if(t.length>1)throw new Error("NbtIntArray only accept one index")},this.text=function(t){for(var i=[],l=0;l<this.childs.length;l++)i.push(this.childs[l].text(t));return`[I; ${i.join(", ")}]`},e)for(var n=0;n<e.length;n++)this.addChild(e[n])}}class m{constructor(e,n=""){n=n.toLowerCase(),n=="b"?Math.round(e)>127?this.value=127:Math.round(e)<-128?this.value=-128:this.value=Math.round(e):n=="s"?Math.round(e)>32767?this.value=32767:Math.round(e)<-32768?this.value=-32768:this.value=Math.round(e):n=="l"?Math.round(e)>9223372036854775807n?this.value=9223372036854775807n:Math.round(e)<-9223372036854775808n?this.value=-9223372036854775808n:this.value=Math.round(e):n=="d"?this.value=y(e):n=="f"?this.value=y(e):n==""?this.value=Math.round(e):this.value=e,this.unit=n,this.text=function(t){return t?`${g(this.value.toString(),"num")}${n?g(this.unit,"unit"):""}`:`${this.value}${n?this.unit:""}`}}}class C{constructor(e){this.value=e,this.text=function(n){let t=this.value.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t");return n?g(`'${t}'`,"str"):`'${t}'`}}}class k{constructor(e){this.value=e?"true":"false",this.text=function(n){return n?g(`${this.value}`,"bool"):`${this.value}`}}}class j{constructor(){this.value=null}text=function(e){return e?g("null","bool"):"null"}}function E(r){if(typeof r=="number")return[r];const e=[];let n="",t=!1,i=!1,l=!1;for(let u=0;u<r.length;u++){const h=r[u];if(t)h==='"'?(t=!1,i&&(l=!0)):n+=h;else if(h==='"'){if(n!=="")throw new Error("Unexpected double quote");t=!0}else if(h==="["){if(i)throw new Error("Nested brackets are not allowed");if(n!=="")e.push(n),n="";else if(e.length===0||typeof e[e.length-1]=="number")throw new Error("Unexpected opening bracket");i=!0,l=!1}else if(h==="]"){if(!i)throw new Error("Unexpected closing bracket");let p=n.trim();if(p==="")throw new Error("Empty brackets are not allowed");if(l)e.push(p);else{if(!/^\d+$/.test(p))throw new Error("Brackets must contain only numbers or quoted strings");e.push(parseInt(p,10))}n="",i=!1}else if(h==="."){if(i)throw new Error("Dot not allowed inside brackets");if(n!=="")e.push(n),n="";else if(u===0||r[u-1]===".")throw new Error("Unexpected dot")}else if(i&&!l){if(!(h===" "||h==="	"))if(h>="0"&&h<="9")n+=h;else throw new Error(`Invalid character in bracket: '${h}'`)}else n+=h}if(t)throw new Error("Unclosed quote");if(i)throw new Error("Unclosed bracket");return n!==""&&e.push(n),e}function A(r){let e=0;const n=r.length;function t(){if(f(),e<n)throw new Error(`Unexpected character: '${r[e]}'. Expected end of input.`)}function i(){if(f(),e>=n)throw new Error("Unexpected end of input");const o=r[e];if(o==="{")return l();if(o==="[")return u();if(o==="'"||o==='"')return h(o);if(/[0-9-]/.test(o))return p();if(o==="t"&&e+4<=n&&r.substr(e,4)==="true")return e+=4,new k(!0);if(o==="f"&&e+5<=n&&r.substr(e,5)==="false")return e+=5,new k(!1);if(o==="n"&&e+4<=n&&r.substr(e,4)==="null")return e+=4,new j;throw new Error(`Unexpected character: ${o}`)}function l(){e++;const o=new x;let s=!1;for(;e<n;){if(f(),r[e]==="}")return e++,o;if(s)if(r[e]===","){if(e++,f(),r[e]==="}")continue}else throw new Error("Expected comma");const a=$();if(f(),!/^['"]/.test(a)&&/^\d/.test(a))throw new Error(`Key cannot start with a digit: ${a}`);if(r[e]!==":")throw new Error("Expected colon");e++,f();const c=i();o.addChild(a,c),s=!0,f()}throw new Error("Unterminated object")}function u(){e++,f();let o;if(r[e]==="I"){if(e++,f(),r[e]!==";")throw new Error("Expected semicolon");e++,o=new N}else o=new I;let s=!1;for(;e<n;){if(f(),r[e]==="]")return e++,o;if(s)if(r[e]===","){if(e++,f(),r[e]==="]")continue}else throw new Error("Expected comma");const a=i();o.addChild(a),s=!0,f()}throw new Error("Unterminated array")}function h(o){e++;let s="",a=!1;for(;e<n;){const c=r[e++];if(a){switch(c){case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;case"0":s+="\0";break;case"\\":s+="\\";break;case"'":s+="'";break;case'"':s+='"';break;case"u":if(e+4>n)throw new Error("Incomplete Unicode escape sequence");const d=r.substring(e,e+4);if(!/^[0-9a-fA-F]{4}$/.test(d))throw new Error(`Invalid Unicode escape: \\u${d}`);s+=String.fromCharCode(parseInt(d,16)),e+=4;break;case"x":if(e+2>n)throw new Error("Incomplete hexadecimal escape sequence");const w=r.substring(e,e+2);if(!/^[0-9a-fA-F]{2}$/.test(w))throw new Error(`Invalid hexadecimal escape: \\x${w}`);s+=String.fromCharCode(parseInt(w,16)),e+=2;break;default:s+="\\"+c}a=!1}else if(c==="\\")a=!0;else{if(c===o)return new C(s);s+=c}}throw new Error("Unterminated string")}function p(){let o=e;for(r[e]==="-"&&e++;e<n&&/[0-9]/.test(r[e]);)e++;if(r[e]===".")for(e++;e<n&&/[0-9]/.test(r[e]);)e++;if(/[eE]/.test(r[e]))for(e++,/[+-]/.test(r[e])&&e++;e<n&&/[0-9]/.test(r[e]);)e++;const s=r.substring(o,e);let a="";if(e<n&&/[bfdisl]/i.test(r[e])&&(a=r[e++]),!/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/.test(s))throw new Error(`Invalid number format: ${s}`);const c=parseFloat(s);if(isNaN(c))throw new Error(`Invalid number: ${s}`);return new m(c,a)}function $(){if(f(),e>=n)throw new Error("Unexpected end of input while parsing key");if(r[e]==="'"||r[e]==='"'){const s=r[e];return e++,v(s)}let o="";for(;e<n;){const s=r[e];if(!/\s/.test(s)&&!/[{}[\]:,]/.test(s))o+=s,e++;else break}if(!o)throw new Error("Empty key is not allowed");return o}function v(o){let s="",a=!1;for(;e<n;){const c=r[e++];if(a){switch(c){case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;case"0":s+="\0";break;case"\\":s+="\\";break;case"'":s+="'";break;case'"':s+='"';break;case"u":if(e+4>n)throw new Error("Incomplete Unicode escape sequence");const d=r.substring(e,e+4);if(!/^[0-9a-fA-F]{4}$/.test(d))throw new Error(`Invalid Unicode escape: \\u${d}`);s+=String.fromCharCode(parseInt(d,16)),e+=4;break;case"x":if(e+2>n)throw new Error("Incomplete hexadecimal escape sequence");const w=r.substring(e,e+2);if(!/^[0-9a-fA-F]{2}$/.test(w))throw new Error(`Invalid hexadecimal escape: \\x${w}`);s+=String.fromCharCode(parseInt(w,16)),e+=2;break;default:s+="\\"+c}a=!1}else if(c==="\\")a=!0;else{if(c===o)return s;s+=c}}throw new Error("Unterminated string")}function f(){for(;e<n&&/\s/.test(r[e]);)e++}try{const o=i();return t(),o}catch(o){const s=r.substring(Math.max(0,e-10),e)+">>"+(r[e]||"")+"<<"+r.substring(e+1,e+10);throw new Error(`${o.message} at position ${e}. Context: ...${s}...`)}}export{k as NbtBool,N as NbtIntArray,I as NbtList,j as NbtNull,m as NbtNumber,x as NbtObject,C as NbtString,y as changeToFloat,g as highlightCode,A as parseNbtString,E as parsePath};
